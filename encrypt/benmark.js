const crypto = require("crypto");
const Benchmark = require("benchmark");

// Dữ liệu mẫu để mã hóa
const data = Buffer.from(`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -0.5 1024 512" shape-rendering="crispEdges">
<metadata>Made with Pixels to Svg https://codepen.io/shshaw/pen/XbxvNj</metadata>
<path stroke="#4c1130" d="M416 96h224M416 97h224M416 98h224M416 99h224M416 100h224M416 101h224M416 102h224M416 103h224M416 104h224M416 105h224M416 106h224M416 107h224M416 108h224M416 109h224M416 110h224M416 111h224M416 112h224M416 113h224M416 114h224M416 115h224M416 116h224M416 117h224M416 118h224M416 119h224M416 120h224M416 121h224M416 122h224M416 123h224M416 124h224M416 125h224M416 126h224M416 127h224M352 128h64M640 128h64M352 129h64M640 129h64M352 130h64M640 130h64M352 131h64M640 131h64M352 132h64M640 132h64M352 133h64M640 133h64M352 134h64M640 134h64M352 135h64M640 135h64M352 136h64M640 136h64M352 137h64M640 137h64M352 138h64M640 138h64M352 139h64M640 139h64M352 140h64M640 140h64M352 141h64M640 141h64M352 142h64M640 142h64M352 143h64M640 143h64M352 144h64M640 144h64M352 145h64M640 145h64M352 146h64M640 146h64M352 147h64M640 147h64M352 148h64M640 148h64M352 149h64M640 149h64M352 150h64M640 150h64M352 151h64M640 151h64M352 152h64M640 152h64M352 153h64M640 153h64M352 154h64M640 154h64M352 155h64M640 155h64M352 156h64M640 156h64M352 157h64M640 157h64M352 158h64M640 158h64M352 159h64M640 159h64M320 160h32M704 160h32M320 161h32M704 161h32M320 162h32M704 162h32M320 163h32M704 163h32M320 164h32M704 164h32M320 165h32M704 165h32M320 166h32M704 166h32M320 167h32M704 167h32M320 168h32M704 168h32M320 169h32M704 169h32M320 170h32M704 170h32M320 171h32M704 171h32M320 172h32M704 172h32M320 173h32M704 173h32M320 174h32M704 174h32M320 175h32M704 175h32M320 176h32M704 176h32M320 177h32M704 177h32M320 178h32M704 178h32M320 179h32M704 179h32M320 180h32M704 180h32M320 181h32M704 181h32M320 182h32M704 182h32M320 183h32M704 183h32M320 184h32M704 184h32M320 185h32M704 185h32M320 186h32M704 186h32M320 187h32M704 187h32M320 188h32M704 188h32M320 189h32M704 189h32M320 190h32M704 190h32M320 191h32M704 191h32M288 192h32M736 192h32M288 193h32M736 193h32M288 194h32M736 194h32M288 195h32M736 195h32M288 196h32M736 196h32M288 197h32M736 197h32M288 198h32M736 198h32M288 199h32M736 199h32M288 200h32M736 200h32M288 201h32M736 201h32M288 202h32M736 202h32M288 203h32M736 203h32M288 204h32M736 204h32M288 205h32M736 205h32M288 206h32M736 206h32M288 207h32M736 207h32M288 208h32M736 208h32M288 209h32M736 209h32M288 210h32M736 210h32M288 211h32M736 211h32M288 212h32M736 212h32M288 213h32M736 213h32M288 214h32M736 214h32M288 215h32M736 215h32M288 216h32M736 216h32M288 217h32M736 217h32M288 218h32M736 218h32M288 219h32M736 219h32M288 220h32M736 220h32M288 221h32M736 221h32M288 222h32M736 222h32M288 223h32M736 223h32M288 224h32M736 224h32M288 225h32M736 225h32M288 226h32M736 226h32M288 227h32M736 227h32M288 228h32M736 228h32M288 229h32M736 229h32M288 230h32M736 230h32M288 231h32M736 231h32M288 232h32M736 232h32M288 233h32M736 233h32M288 234h32M736 234h32M288 235h32M736 235h32M288 236h32M736 236h32M288 237h32M736 237h32M288 238h32M736 238h32M288 239h32M736 239h32M288 240h32M736 240h32M288 241h32M736 241h32M288 242h32M736 242h32M288 243h32M736 243h32M288 244h32M736 244h32M288 245h32M736 245h32M288 246h32M736 246h32M288 247h32M736 247h32M288 248h32M736 248h32M288 249h32M736 249h32M288 250h32M736 250h32M288 251h32M736 251h32M288 252h32M736 252h32M288 253h32M736 253h32M288 254h32M736 254h32M288 255h32M736 255h32M256 256h32M768 256h32M256 257h32M768 257h32M256 258h32M768 258h32M256 259h32M768 259h32M256 260h32M768 260h32M256 261h32M768 261h32M256 262h32M768 262h32M256 263h32M768 263h32M256 264h32M768 264h32M256 265h32M768 265h32M256 266h32M768 266h32M256 267h32M768 267h32M256 268h32M768 268h32M256 269h32M768 269h32M256 270h32M768 270h32M256 271h32M768 271h32M256 272h32M768 272h32M256 273h32M768 273h32M256 274h32M768 274h32M256 275h32M768 275h32M256 276h32M768 276h32M256 277h32M768 277h32M256 278h32M768 278h32M256 279h32M768 279h32M256 280h32M768 280h32M256 281h32M768 281h32M256 282h32M768 282h32M256 283h32M768 283h32M256 284h32M768 284h32M256 285h32M768 285h32M256 286h32M768 286h32M256 287h32M768 287h32M256 288h32M768 288h32M256 289h32M768 289h32M256 290h32M768 290h32M256 291h32M768 291h32M256 292h32M768 292h32M256 293h32M768 293h32M256 294h32M768 294h32M256 295h32M768 295h32M256 296h32M768 296h32M256 297h32M768 297h32M256 298h32M768 298h32M256 299h32M768 299h32M256 300h32M768 300h32M256 301h32M768 301h32M256 302h32M768 302h32M256 303h32M768 303h32M256 304h32M768 304h32M256 305h32M768 305h32M256 306h32M768 306h32M256 307h32M768 307h32M256 308h32M768 308h32M256 309h32M768 309h32M256 310h32M768 310h32M256 311h32M768 311h32M256 312h32M768 312h32M256 313h32M768 313h32M256 314h32M768 314h32M256 315h32M768 315h32M256 316h32M768 316h32M256 317h32M768 317h32M256 318h32M768 318h32M256 319h32M768 319h32M256 320h32M768 320h32M256 321h32M768 321h32M256 322h32M768 322h32M256 323h32M768 323h32M256 324h32M768 324h32M256 325h32M768 325h32M256 326h32M768 326h32M256 327h32M768 327h32M256 328h32M768 328h32M256 329h32M768 329h32M256 330h32M768 330h32M256 331h32M768 331h32M256 332h32M768 332h32M256 333h32M768 333h32M256 334h32M768 334h32M256 335h32M768 335h32M256 336h32M768 336h32M256 337h32M768 337h32M256 338h32M768 338h32M256 339h32M768 339h32M256 340h32M768 340h32M256 341h32M768 341h32M256 342h32M768 342h32M256 343h32M768 343h32M256 344h32M768 344h32M256 345h32M768 345h32M256 346h32M768 346h32M256 347h32M768 347h32M256 348h32M768 348h32M256 349h32M768 349h32M256 350h32M768 350h32M256 351h32M768 351h32M256 352h32M768 352h32M256 353h32M768 353h32M256 354h32M768 354h32M256 355h32M768 355h32M256 356h32M768 356h32M256 357h32M768 357h32M256 358h32M768 358h32M256 359h32M768 359h32M256 360h32M768 360h32M256 361h32M768 361h32M256 362h32M768 362h32M256 363h32M768 363h32M256 364h32M768 364h32M256 365h32M768 365h32M256 366h32M768 366h32M256 367h32M768 367h32M256 368h32M768 368h32M256 369h32M768 369h32M256 370h32M768 370h32M256 371h32M768 371h32M256 372h32M768 372h32M256 373h32M768 373h32M256 374h32M768 374h32M256 375h32M768 375h32M256 376h32M768 376h32M256 377h32M768 377h32M256 378h32M768 378h32M256 379h32M768 379h32M256 380h32M768 380h32M256 381h32M768 381h32M256 382h32M768 382h32M256 383h32M768 383h32M288 384h32M736 384h32M288 385h32M736 385h32M288 386h32M736 386h32M288 387h32M736 387h32M288 388h32M736 388h32M288 389h32M736 389h32M288 390h32M736 390h32M288 391h32M736 391h32M288 392h32M736 392h32M288 393h32M736 393h32M288 394h32M736 394h32M288 395h32M736 395h32M288 396h32M736 396h32M288 397h32M736 397h32M288 398h32M736 398h32M288 399h32M736 399h32M288 400h32M736 400h32M288 401h32M736 401h32M288 402h32M736 402h32M288 403h32M736 403h32M288 404h32M736 404h32M288 405h32M736 405h32M288 406h32M736 406h32M288 407h32M736 407h32M288 408h32M736 408h32M288 409h32M736 409h32M288 410h32M736 410h32M288 411h32M736 411h32M288 412h32M736 412h32M288 413h32M736 413h32M288 414h32M736 414h32M288 415h32M736 415h32M320 416h416M320 417h416M320 418h416M320 419h416M320 420h416M320 421h416M320 422h416M320 423h416M320 424h416M320 425h416M320 426h416M320 427h416M320 428h416M320 429h416M320 430h416M320 431h416M320 432h416M320 433h416M320 434h416M320 435h416M320 436h416M320 437h416M320 438h416M320 439h416M320 440h416M320 441h416M320 442h416M320 443h416M320 444h416M320 445h416M320 446h416M320 447h416" />
<path stroke="#a64d79" d="M416 128h32M416 129h32M416 130h32M416 131h32M416 132h32M416 133h32M416 134h32M416 135h32M416 136h32M416 137h32M416 138h32M416 139h32M416 140h32M416 141h32M416 142h32M416 143h32M416 144h32M416 145h32M416 146h32M416 147h32M416 148h32M416 149h32M416 150h32M416 151h32M416 152h32M416 153h32M416 154h32M416 155h32M416 156h32M416 157h32M416 158h32M416 159h32M352 160h32M352 161h32M352 162h32M352 163h32M352 164h32M352 165h32M352 166h32M352 167h32M352 168h32M352 169h32M352 170h32M352 171h32M352 172h32M352 173h32M352 174h32M352 175h32M352 176h32M352 177h32M352 178h32M352 179h32M352 180h32M352 181h32M352 182h32M352 183h32M352 184h32M352 185h32M352 186h32M352 187h32M352 188h32M352 189h32M352 190h32M352 191h32M320 192h32M320 193h32M320 194h32M320 195h32M320 196h32M320 197h32M320 198h32M320 199h32M320 200h32M320 201h32M320 202h32M320 203h32M320 204h32M320 205h32M320 206h32M320 207h32M320 208h32M320 209h32M320 210h32M320 211h32M320 212h32M320 213h32M320 214h32M320 215h32M320 216h32M320 217h32M320 218h32M320 219h32M320 220h32M320 221h32M320 222h32M320 223h32M288 256h32M288 257h32M288 258h32M288 259h32M288 260h32M288 261h32M288 262h32M288 263h32M288 264h32M288 265h32M288 266h32M288 267h32M288 268h32M288 269h32M288 270h32M288 271h32M288 272h32M288 273h32M288 274h32M288 275h32M288 276h32M288 277h32M288 278h32M288 279h32M288 280h32M288 281h32M288 282h32M288 283h32M288 284h32M288 285h32M288 286h32M288 287h32M288 288h32M288 289h32M288 290h32M288 291h32M288 292h32M288 293h32M288 294h32M288 295h32M288 296h32M288 297h32M288 298h32M288 299h32M288 300h32M288 301h32M288 302h32M288 303h32M288 304h32M288 305h32M288 306h32M288 307h32M288 308h32M288 309h32M288 310h32M288 311h32M288 312h32M288 313h32M288 314h32M288 315h32M288 316h32M288 317h32M288 318h32M288 319h32M288 320h32M288 321h32M288 322h32M288 323h32M288 324h32M288 325h32M288 326h32M288 327h32M288 328h32M288 329h32M288 330h32M288 331h32M288 332h32M288 333h32M288 334h32M288 335h32M288 336h32M288 337h32M288 338h32M288 339h32M288 340h32M288 341h32M288 342h32M288 343h32M288 344h32M288 345h32M288 346h32M288 347h32M288 348h32M288 349h32M288 350h32M288 351h32M288 352h64M736 352h32M288 353h64M736 353h32M288 354h64M736 354h32M288 355h64M736 355h32M288 356h64M736 356h32M288 357h64M736 357h32M288 358h64M736 358h32M288 359h64M736 359h32M288 360h64M736 360h32M288 361h64M736 361h32M288 362h64M736 362h32M288 363h64M736 363h32M288 364h64M736 364h32M288 365h64M736 365h32M288 366h64M736 366h32M288 367h64M736 367h32M288 368h64M736 368h32M288 369h64M736 369h32M288 370h64M736 370h32M288 371h64M736 371h32M288 372h64M736 372h32M288 373h64M736 373h32M288 374h64M736 374h32M288 375h64M736 375h32M288 376h64M736 376h32M288 377h64M736 377h32M288 378h64M736 378h32M288 379h64M736 379h32M288 380h64M736 380h32M288 381h64M736 381h32M288 382h64M736 382h32M288 383h64M736 383h32M320 384h128M672 384h64M320 385h128M672 385h64M320 386h128M672 386h64M320 387h128M672 387h64M320 388h128M672 388h64M320 389h128M672 389h64M320 390h128M672 390h64M320 391h128M672 391h64M320 392h128M672 392h64M320 393h128M672 393h64M320 394h128M672 394h64M320 395h128M672 395h64M320 396h128M672 396h64M320 397h128M672 397h64M320 398h128M672 398h64M320 399h128M672 399h64M320 400h128M672 400h64M320 401h128M672 401h64M320 402h128M672 402h64M320 403h128M672 403h64M320 404h128M672 404h64M320 405h128M672 405h64M320 406h128M672 406h64M320 407h128M672 407h64M320 408h128M672 408h64M320 409h128M672 409h64M320 410h128M672 410h64M320 411h128M672 411h64M320 412h128M672 412h64M320 413h128M672 413h64M320 414h128M672 414h64M320 415h128M672 415h64" />
<path stroke="#c27ba0" d="M448 128h32M448 129h32M448 130h32M448 131h32M448 132h32M448 133h32M448 134h32M448 135h32M448 136h32M448 137h32M448 138h32M448 139h32M448 140h32M448 141h32M448 142h32M448 143h32M448 144h32M448 145h32M448 146h32M448 147h32M448 148h32M448 149h32M448 150h32M448 151h32M448 152h32M448 153h32M448 154h32M448 155h32M448 156h32M448 157h32M448 158h32M448 159h32M384 160h64M672 160h32M384 161h64M672 161h32M384 162h64M672 162h32M384 163h64M672 163h32M384 164h64M672 164h32M384 165h64M672 165h32M384 166h64M672 166h32M384 167h64M672 167h32M384 168h64M672 168h32M384 169h64M672 169h32M384 170h64M672 170h32M384 171h64M672 171h32M384 172h64M672 172h32M384 173h64M672 173h32M384 174h64M672 174h32M384 175h64M672 175h32M384 176h64M672 176h32M384 177h64M672 177h32M384 178h64M672 178h32M384 179h64M672 179h32M384 180h64M672 180h32M384 181h64M672 181h32M384 182h64M672 182h32M384 183h64M672 183h32M384 184h64M672 184h32M384 185h64M672 185h32M384 186h64M672 186h32M384 187h64M672 187h32M384 188h64M672 188h32M384 189h64M672 189h32M384 190h64M672 190h32M384 191h64M672 191h32M352 192h64M704 192h32M352 193h64M704 193h32M352 194h64M704 194h32M352 195h64M704 195h32M352 196h64M704 196h32M352 197h64M704 197h32M352 198h64M704 198h32M352 199h64M704 199h32M352 200h64M704 200h32M352 201h64M704 201h32M352 202h64M704 202h32M352 203h64M704 203h32M352 204h64M704 204h32M352 205h64M704 205h32M352 206h64M704 206h32M352 207h64M704 207h32M352 208h64M704 208h32M352 209h64M704 209h32M352 210h64M704 210h32M352 211h64M704 211h32M352 212h64M704 212h32M352 213h64M704 213h32M352 214h64M704 214h32M352 215h64M704 215h32M352 216h64M704 216h32M352 217h64M704 217h32M352 218h64M704 218h32M352 219h64M704 219h32M352 220h64M704 220h32M352 221h64M704 221h32M352 222h64M704 222h32M352 223h64M704 223h32M320 224h32M320 225h32M320 226h32M320 227h32M320 228h32M320 229h32M320 230h32M320 231h32M320 232h32M320 233h32M320 234h32M320 235h32M320 236h32M320 237h32M320 238h32M320 239h32M320 240h32M320 241h32M320 242h32M320 243h32M320 244h32M320 245h32M320 246h32M320 247h32M320 248h32M320 249h32M320 250h32M320 251h32M320 252h32M320 253h32M320 254h32M320 255h32M352 256h64M736 256h32M352 257h64M736 257h32M352 258h64M736 258h32M352 259h64M736 259h32M352 260h64M736 260h32M352 261h64M736 261h32M352 262h64M736 262h32M352 263h64M736 263h32M352 264h64M736 264h32M352 265h64M736 265h32M352 266h64M736 266h32M352 267h64M736 267h32M352 268h64M736 268h32M352 269h64M736 269h32M352 270h64M736 270h32M352 271h64M736 271h32M352 272h64M736 272h32M352 273h64M736 273h32M352 274h64M736 274h32M352 275h64M736 275h32M352 276h64M736 276h32M352 277h64M736 277h32M352 278h64M736 278h32M352 279h64M736 279h32M352 280h64M736 280h32M352 281h64M736 281h32M352 282h64M736 282h32M352 283h64M736 283h32M352 284h64M736 284h32M352 285h64M736 285h32M352 286h64M736 286h32M352 287h64M736 287h32M320 288h128M736 288h32M320 289h128M736 289h32M320 290h128M736 290h32M320 291h128M736 291h32M320 292h128M736 292h32M320 293h128M736 293h32M320 294h128M736 294h32M320 295h128M736 295h32M320 296h128M736 296h32M320 297h128M736 297h32M320 298h128M736 298h32M320 299h128M736 299h32M320 300h128M736 300h32M320 301h128M736 301h32M320 302h128M736 302h32M320 303h128M736 303h32M320 304h128M736 304h32M320 305h128M736 305h32M320 306h128M736 306h32M320 307h128M736 307h32M320 308h128M736 308h32M320 309h128M736 309h32M320 310h128M736 310h32M320 311h128M736 311h32M320 312h128M736 312h32M320 313h128M736 313h32M320 314h128M736 314h32M320 315h128M736 315h32M320 316h128M736 316h32M320 317h128M736 317h32M320 318h128M736 318h32M320 319h128M736 319h32M320 320h192M704 320h64M320 321h192M704 321h64M320 322h192M704 322h64M320 323h192M704 323h64M320 324h192M704 324h64M320 325h192M704 325h64M320 326h192M704 326h64M320 327h192M704 327h64M320 328h192M704 328h64M320 329h192M704 329h64M320 330h192M704 330h64M320 331h192M704 331h64M320 332h192M704 332h64M320 333h192M704 333h64M320 334h192M704 334h64M320 335h192M704 335h64M320 336h192M704 336h64M320 337h192M704 337h64M320 338h192M704 338h64M320 339h192M704 339h64M320 340h192M704 340h64M320 341h192M704 341h64M320 342h192M704 342h64M320 343h192M704 343h64M320 344h192M704 344h64M320 345h192M704 345h64M320 346h192M704 346h64M320 347h192M704 347h64M320 348h192M704 348h64M320 349h192M704 349h64M320 350h192M704 350h64M320 351h192M704 351h64M352 352h384M352 353h384M352 354h384M352 355h384M352 356h384M352 357h384M352 358h384M352 359h384M352 360h384M352 361h384M352 362h384M352 363h384M352 364h384M352 365h384M352 366h384M352 367h384M352 368h384M352 369h384M352 370h384M352 371h384M352 372h384M352 373h384M352 374h384M352 375h384M352 376h384M352 377h384M352 378h384M352 379h384M352 380h384M352 381h384M352 382h384M352 383h384M448 384h224M448 385h224M448 386h224M448 387h224M448 388h224M448 389h224M448 390h224M448 391h224M448 392h224M448 393h224M448 394h224M448 395h224M448 396h224M448 397h224M448 398h224M448 399h224M448 400h224M448 401h224M448 402h224M448 403h224M448 404h224M448 405h224M448 406h224M448 407h224M448 408h224M448 409h224M448 410h224M448 411h224M448 412h224M448 413h224M448 414h224M448 415h224" />
<path stroke="#d5a6bd" d="M480 128h160M480 129h160M480 130h160M480 131h160M480 132h160M480 133h160M480 134h160M480 135h160M480 136h160M480 137h160M480 138h160M480 139h160M480 140h160M480 141h160M480 142h160M480 143h160M480 144h160M480 145h160M480 146h160M480 147h160M480 148h160M480 149h160M480 150h160M480 151h160M480 152h160M480 153h160M480 154h160M480 155h160M480 156h160M480 157h160M480 158h160M480 159h160M448 160h128M640 160h32M448 161h128M640 161h32M448 162h128M640 162h32M448 163h128M640 163h32M448 164h128M640 164h32M448 165h128M640 165h32M448 166h128M640 166h32M448 167h128M640 167h32M448 168h128M640 168h32M448 169h128M640 169h32M448 170h128M640 170h32M448 171h128M640 171h32M448 172h128M640 172h32M448 173h128M640 173h32M448 174h128M640 174h32M448 175h128M640 175h32M448 176h128M640 176h32M448 177h128M640 177h32M448 178h128M640 178h32M448 179h128M640 179h32M448 180h128M640 180h32M448 181h128M640 181h32M448 182h128M640 182h32M448 183h128M640 183h32M448 184h128M640 184h32M448 185h128M640 185h32M448 186h128M640 186h32M448 187h128M640 187h32M448 188h128M640 188h32M448 189h128M640 189h32M448 190h128M640 190h32M448 191h128M640 191h32M416 192h160M672 192h32M416 193h160M672 193h32M416 194h160M672 194h32M416 195h160M672 195h32M416 196h160M672 196h32M416 197h160M672 197h32M416 198h160M672 198h32M416 199h160M672 199h32M416 200h160M672 200h32M416 201h160M672 201h32M416 202h160M672 202h32M416 203h160M672 203h32M416 204h160M672 204h32M416 205h160M672 205h32M416 206h160M672 206h32M416 207h160M672 207h32M416 208h160M672 208h32M416 209h160M672 209h32M416 210h160M672 210h32M416 211h160M672 211h32M416 212h160M672 212h32M416 213h160M672 213h32M416 214h160M672 214h32M416 215h160M672 215h32M416 216h160M672 216h32M416 217h160M672 217h32M416 218h160M672 218h32M416 219h160M672 219h32M416 220h160M672 220h32M416 221h160M672 221h32M416 222h160M672 222h32M416 223h160M672 223h32M448 224h128M672 224h64M448 225h128M672 225h64M448 226h128M672 226h64M448 227h128M672 227h64M448 228h128M672 228h64M448 229h128M672 229h64M448 230h128M672 230h64M448 231h128M672 231h64M448 232h128M672 232h64M448 233h128M672 233h64M448 234h128M672 234h64M448 235h128M672 235h64M448 236h128M672 236h64M448 237h128M672 237h64M448 238h128M672 238h64M448 239h128M672 239h64M448 240h128M672 240h64M448 241h128M672 241h64M448 242h128M672 242h64M448 243h128M672 243h64M448 244h128M672 244h64M448 245h128M672 245h64M448 246h128M672 246h64M448 247h128M672 247h64M448 248h128M672 248h64M448 249h128M672 249h64M448 250h128M672 250h64M448 251h128M672 251h64M448 252h128M672 252h64M448 253h128M672 253h64M448 254h128M672 254h64M448 255h128M672 255h64M416 256h256M704 256h32M416 257h256M704 257h32M416 258h256M704 258h32M416 259h256M704 259h32M416 260h256M704 260h32M416 261h256M704 261h32M416 262h256M704 262h32M416 263h256M704 263h32M416 264h256M704 264h32M416 265h256M704 265h32M416 266h256M704 266h32M416 267h256M704 267h32M416 268h256M704 268h32M416 269h256M704 269h32M416 270h256M704 270h32M416 271h256M704 271h32M416 272h256M704 272h32M416 273h256M704 273h32M416 274h256M704 274h32M416 275h256M704 275h32M416 276h256M704 276h32M416 277h256M704 277h32M416 278h256M704 278h32M416 279h256M704 279h32M416 280h256M704 280h32M416 281h256M704 281h32M416 282h256M704 282h32M416 283h256M704 283h32M416 284h256M704 284h32M416 285h256M704 285h32M416 286h256M704 286h32M416 287h256M704 287h32M448 288h288M448 289h288M448 290h288M448 291h288M448 292h288M448 293h288M448 294h288M448 295h288M448 296h288M448 297h288M448 298h288M448 299h288M448 300h288M448 301h288M448 302h288M448 303h288M448 304h288M448 305h288M448 306h288M448 307h288M448 308h288M448 309h288M448 310h288M448 311h288M448 312h288M448 313h288M448 314h288M448 315h288M448 316h288M448 317h288M448 318h288M448 319h288M512 320h192M512 321h192M512 322h192M512 323h192M512 324h192M512 325h192M512 326h192M512 327h192M512 328h192M512 329h192M512 330h192M512 331h192M512 332h192M512 333h192M512 334h192M512 335h192M512 336h192M512 337h192M512 338h192M512 339h192M512 340h192M512 341h192M512 342h192M512 343h192M512 344h192M512 345h192M512 346h192M512 347h192M512 348h192M512 349h192M512 350h192M512 351h192" />
<path stroke="#d9d2e9" d="M576 160h32M576 161h32M576 162h32M576 163h32M576 164h32M576 165h32M576 166h32M576 167h32M576 168h32M576 169h32M576 170h32M576 171h32M576 172h32M576 173h32M576 174h32M576 175h32M576 176h32M576 177h32M576 178h32M576 179h32M576 180h32M576 181h32M576 182h32M576 183h32M576 184h32M576 185h32M576 186h32M576 187h32M576 188h32M576 189h32M576 190h32M576 191h32M576 192h96M576 193h96M576 194h96M576 195h96M576 196h96M576 197h96M576 198h96M576 199h96M576 200h96M576 201h96M576 202h96M576 203h96M576 204h96M576 205h96M576 206h96M576 207h96M576 208h96M576 209h96M576 210h96M576 211h96M576 212h96M576 213h96M576 214h96M576 215h96M576 216h96M576 217h96M576 218h96M576 219h96M576 220h96M576 221h96M576 222h96M576 223h96" />
<path stroke="#eee9fa" d="M608 160h32M608 161h32M608 162h32M608 163h32M608 164h32M608 165h32M608 166h32M608 167h32M608 168h32M608 169h32M608 170h32M608 171h32M608 172h32M608 173h32M608 174h32M608 175h32M608 176h32M608 177h32M608 178h32M608 179h32M608 180h32M608 181h32M608 182h32M608 183h32M608 184h32M608 185h32M608 186h32M608 187h32M608 188h32M608 189h32M608 190h32M608 191h32" />
<path stroke="#000000" d="M352 224h96M576 224h96M352 225h96M576 225h96M352 226h96M576 226h96M352 227h96M576 227h96M352 228h96M576 228h96M352 229h96M576 229h96M352 230h96M576 230h96M352 231h96M576 231h96M352 232h96M576 232h96M352 233h96M576 233h96M352 234h96M576 234h96M352 235h96M576 235h96M352 236h96M576 236h96M352 237h96M576 237h96M352 238h96M576 238h96M352 239h96M576 239h96M352 240h96M576 240h96M352 241h96M576 241h96M352 242h96M576 242h96M352 243h96M576 243h96M352 244h96M576 244h96M352 245h96M576 245h96M352 246h96M576 246h96M352 247h96M576 247h96M352 248h96M576 248h96M352 249h96M576 249h96M352 250h96M576 250h96M352 251h96M576 251h96M352 252h96M576 252h96M352 253h96M576 253h96M352 254h96M576 254h96M352 255h96M576 255h96" />
<path stroke="#f56060" d="M320 256h32M672 256h32M320 257h32M672 257h32M320 258h32M672 258h32M320 259h32M672 259h32M320 260h32M672 260h32M320 261h32M672 261h32M320 262h32M672 262h32M320 263h32M672 263h32M320 264h32M672 264h32M320 265h32M672 265h32M320 266h32M672 266h32M320 267h32M672 267h32M320 268h32M672 268h32M320 269h32M672 269h32M320 270h32M672 270h32M320 271h32M672 271h32M320 272h32M672 272h32M320 273h32M672 273h32M320 274h32M672 274h32M320 275h32M672 275h32M320 276h32M672 276h32M320 277h32M672 277h32M320 278h32M672 278h32M320 279h32M672 279h32M320 280h32M672 280h32M320 281h32M672 281h32M320 282h32M672 282h32M320 283h32M672 283h32M320 284h32M672 284h32M320 285h32M672 285h32M320 286h32M672 286h32M320 287h32M672 287h32" />
</svg>     
`);

// Các hàm mã hóa cho từng thuật toán
function encryptChacha20() {
  const key = crypto.randomBytes(32);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("chacha20", key, iv, {
    authTagLength: 16,
  });
  cipher.update(data);
}

function encryptChacha20Poly1305() {
  const key = crypto.randomBytes(32);
  const nonce = crypto.randomBytes(12);
  const cipher = crypto.createCipheriv("chacha20-poly1305", key, nonce);
  cipher.setAAD(Buffer.alloc(0));
  cipher.update(data);
  cipher.final();
}

function encryptAES128GCM() {
  const key = crypto.randomBytes(16);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-128-gcm", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES192GCM() {
  const key = crypto.randomBytes(24);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-192-gcm", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES256GCM() {
  const key = crypto.randomBytes(32);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-256-gcm", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES128CCM(data) {
  const key = crypto.randomBytes(16);
  const nonce = crypto.randomBytes(12);

  const cipher = crypto.createCipheriv("aes-128-ccm", key, nonce, {
    authTagLength: 16,
  });
  cipher.setAAD(Buffer.alloc(0));
  cipher.update(data);
  const encrypted = Buffer.concat([cipher.final(), cipher.getAuthTag()]);

  return { key, nonce, encrypted };
}

function encryptAES192CCM(data) {
  const key = crypto.randomBytes(24);
  const nonce = crypto.randomBytes(12);

  const cipher = crypto.createCipheriv("aes-192-ccm", key, nonce, {
    authTagLength: 16,
  });
  cipher.setAAD(Buffer.alloc(0));
  cipher.update(data);
  const encrypted = Buffer.concat([cipher.final(), cipher.getAuthTag()]);

  return { key, nonce, encrypted };
}

function encryptAES256CCM(data) {
  const key = crypto.randomBytes(32);
  const nonce = crypto.randomBytes(12);

  const cipher = crypto.createCipheriv("aes-256-ccm", key, nonce, {
    authTagLength: 16,
  });
  cipher.setAAD(Buffer.alloc(0));
  cipher.update(data);
  const encrypted = Buffer.concat([cipher.final(), cipher.getAuthTag()]);

  return { key, nonce, encrypted };
}

function encryptAES128CTR() {
  const key = crypto.randomBytes(16);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-128-ctr", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES192CTR() {
  const key = crypto.randomBytes(24);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-192-ctr", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES256CTR() {
  const key = crypto.randomBytes(32);
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-256-ctr", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES128XTS() {
  const key = Buffer.concat([crypto.randomBytes(16), crypto.randomBytes(16)]); // Khóa dài 32 byte
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-128-xts", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES256XTS() {
  const key = Buffer.concat([crypto.randomBytes(32), crypto.randomBytes(32)]); // Khóa dài 64 byte
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-256-xts", key, iv);
  cipher.update(data);
  cipher.final();
}

function encryptAES128ECB() {
  const key = crypto.randomBytes(16);
  const cipher = crypto.createCipheriv("aes-128-ecb", key, null);
  cipher.update(data);
  cipher.final("hex");
}

function encryptAES256ECB() {
  const key = crypto.randomBytes(32);
  const cipher = crypto.createCipheriv("aes-256-ecb", key, null);
  cipher.update(data);
  cipher.final("hex");
}

function encryptAES192ECB() {
  const key = crypto.randomBytes(24);
  const cipher = crypto.createCipheriv("aes-192-ecb", key, null);
  cipher.update(data);
  cipher.final("hex");
}

const suite = new Benchmark.Suite();

// suite.add('chacha20 encryption', encryptChacha20);
// suite.add('chacha20-poly1305 encryption', encryptChacha20Poly1305);
// suite.add('aes-128-gcm encryption', encryptAES128GCM);
// suite.add('aes-192-gcm encryption', encryptAES192GCM);
// suite.add('aes-256-gcm encryption', encryptAES256GCM);
// suite.add('aes-128-ccm encryption', encryptAES128CCM);
// suite.add('aes-192-ccm encryption', encryptAES192CCM);
// suite.add('aes-256-ccm encryption', encryptAES256CCM);
// suite.add("aes-128-ctr encryption", encryptAES128CTR);
// suite.add("aes-192-ctr encryption", encryptAES192CTR);
// suite.add("aes-256-ctr encryption", encryptAES256CTR);
// suite.add('aes-128-xts encryption', encryptAES128XTS);
// suite.add('aes-256-xts encryption', encryptAES256XTS);
suite.add("aes-128-ecb encryption", encryptAES128ECB);
suite.add("aes-192-ecb encryption", encryptAES192ECB);
suite.add("aes-256-ecb encryption", encryptAES256ECB);

suite
  .on("cycle", (event) => {
    console.log(String(event.target));
  })
  .on("complete", function () {
    console.log(`Fastest is ${this.filter("fastest").map("name")}`);
  })
  .run({ async: true });
